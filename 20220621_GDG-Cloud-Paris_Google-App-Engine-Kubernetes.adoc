= 2022/06/21 - Google Developer Group Cloud Paris - SoirÃ©e Google App Engine / Kubernetes
Thomas SCHWENDER <icon:github[] https://github.com/Ardemius/[GitHub] / icon:twitter[role="aqua"] https://twitter.com/thomasschwender[@thomasschwender]>
// Handling GitHub admonition blocks icons
ifndef::env-github[:icons: font]
ifdef::env-github[]
:status:
:outfilesuffix: .adoc
:caution-caption: :fire:
:important-caption: :exclamation:
:note-caption: :paperclip:
:tip-caption: :bulb:
:warning-caption: :warning:
endif::[]
:imagesdir: ./images
:source-highlighter: highlightjs
:highlightjs-languages: asciidoc
// We must enable experimental attribute to display Keyboard, button, and menu macros
:experimental:
// Next 2 ones are to handle line breaks in some particular elements (list, footnotes, etc.)
:lb: pass:[<br> +]
:sb: pass:[<br>]
// check https://github.com/Ardemius/personal-wiki/wiki/AsciiDoctor-tips for tips on table of content in GitHub
:toc: macro
:toclevels: 4
// To number the sections of the table of contents
//:sectnums:
// Add an anchor with hyperlink before the section title
:sectanchors:
// To turn off figure caption labels and numbers
:figure-caption!:
// Same for examples
//:example-caption!:
// To turn off ALL captions
// :caption:

toc::[]

* Event du *Google Developer Group Cloud*, chez Malt, le 21/06/2022
* Description de l'Ã©vÃ¨nement : https://gdg.community.dev/events/details/google-gdg-cloud-paris-presents-soiree-google-app-engine-kubernetes/

== Google App Engine, le mÃªme, en mieux

=== Abstract

PrÃ©sentÃ© par Ludovic Champenois / Google

----
App Engine, le premier produit Cloud de Google, bien avant Google Cloud Platform...

12 ans aprÃ¨s, toujours d'actualitÃ©, avec Java 11, Java 17, et Ã  nouveau les "Bundled Services", les APIs App Engine d'origine, qui ont fait le succes de la "Plateform As A Service." Le tout maintenant en Open Source sur github.

Ludovic Champenois est Responsable Google Cloud Platform Serverless pour Java App Engine, Fonctions et Buildpacks chez Google

https://twitter.com/ludoch
----

=== Notes

* Anecdote : Ã  la base Kubernetes Ã©tait un projet crÃ©Ã© par des ingÃ©nieurs App Engine

* Ludovic a Ã©migrÃ© aux Etats-Unis en 1994
* Il avait rejoint Sun Microsystems en 1996
* Quand Oracle a rachetÃ© Sun, Ludovic a cherchÃ© "n'importe oÃ¹ ailleurs", et Google l'a pris...
    ** cela fait 11 ans qu'il travaille sur App Engine, et compte bien ne faire que Ã§a jusqu'Ã  sa retraite
    ** crÃ©ation de App Engine en 2009

* Ludovic a crÃ©Ã© un compte Twitter qui s'appelle AppEngine Java qui relate l'histoire de App Engine
    ** 1er poste : la crÃ©ation de App Engine par Guido Van Rossum, ingÃ©nieur Google qui a crÃ©Ã© Python

* Ludovic : Google App Engine est l'un des pionniers du PaaS
* Et le code que l'on va faire tourner aujourd'hui date de 10 ans
    ** Mais cette fois il a Ã©tÃ© mis Ã  jour pour tourner sur Java 17 et plus Java 6 ðŸ˜‰ 

Demo faite sur NetBeans IDE 14 ! ðŸ™‚ 

* La demo utilise Quarkus
* et on utilise toujours des servlets (et donc du JEE)
    ** ces APIs sont donc HYPER stables (merci Java !)
* Ludovic a "ressucitÃ©" le code rien que pour nous...
* Historiquement, *Cloud Build* est un service qui a Ã©tÃ© crÃ©Ã© pour App Engine.

* Cloud Run Buildpacks -> fichier .tgz que l'on va sauvegarder dans une BDD Spanner

* nouvelle couche de sÃ©curitÃ© de Google Cloud (nouvelle sandbox) : *gVisor*
    ** elle aussi a Ã©tÃ© crÃ©Ã©e par les Ã©quipes App Engine une fois constatÃ©s les problÃ¨mes provenant de l'ancienne sandbox

* Depuis 4 mois, Ludovic a mis TOUT le code App Engine sur GitHub

* Ludovic : Docker n'est PAS secure, quand on le fait tourner, on peut "voir" qui le fait tourner (le host)

.Toute l'histoire de Google App Engine
image:20220621_GDG-Cloud-Paris_Google-App-Engine-Kubernetes_01.jpg[]

* Cloud Run sert des Docker images
    ** La seule chose qu'on rajoute est gVisor

.Quand Cloud Run tourne, il le fait avec la derniÃ¨re image dispo ici :
image:20220621_GDG-Cloud-Paris_Google-App-Engine-Kubernetes_02.jpg[]

-> Regardez la derniÃ¨re colonne, et le nombre de vulnÃ©rabilitÃ©s...

    * Alors qu'avec App Engine, Ã  chaque relance on redÃ©ploie ET on a la derniÃ¨re version (Ã  vÃ©rifier !)

En fait, GAE est FULLY managed :

    * contrat avec Ubuntu
    * contrat avec Jetty
    * rien Ã  payer pour vous, c'est gÃ©rÃ© (et payÃ©) par Google

Ressources : 

    * Open Source : https://github.com/GoogleCloudPlatform/appengine-java-standard
    * Bundled Services : 
        ** https://cloud.google.com/appengine/docs/standard/java-gen2/services/access
        ** https://github.com/GoogleCloudPlatform/java-docs-samples/...

== PlongÃ©e dans la rÃ©volution Kubernetes

=== Abstract

PrÃ©sentÃ© par Alain Regnier / Kubo Labs

----
Avec lâ€™arrivÃ©e des containers et surtout de lâ€™orchestrateur Kubernetes le monde de lâ€™IT est en plein bouleversement. Architecture, DÃ©veloppement, Mise en Production, Management, Monitoring... tout est impactÃ© Ã  plus ou moins grande Ã©chelle.

Au cours de cette prÃ©sentation, nous reviendrons dâ€™abord sur lâ€™histoire de Kubernetes, ce que Kubernetes permet de faire et sa mise en place. Nous verrons ensuite comment le quotidien des dÃ©veloppeurs est impactÃ© par cette rÃ©volution et les nouveaux outils disponibles. Enfin nous verrons comment se dÃ©roule le dÃ©ploiement dâ€™une application sur un cluster Kubernetes.

Le tout sera accompagnÃ© de retours dâ€™expÃ©riences et de bonnes pratiques.

Alain Regnier est CTO chez Kubo Labs (spÃ©cialiste Kubernetes)

https://www.kubolabs.io
----

=== Notes

* Alain : "Kubernetes est une solution trÃ¨s complexe", et avec Kudo Labs on essaye de simplifier les choses...

.On commence par quelques rappels...
image:20220621_GDG-Cloud-Paris_Google-App-Engine-Kubernetes_03.jpg[]

* Kubernetes est un terme qui vient du grec et qui veut dire "*timonier*"

.Le principe principal de Kubernetes
IMPORTANT: DÃ©clarer la cible Ã  atteindre et laisser le systÃ¨me la maintenir.

.Google et les containers
image:20220621_GDG-Cloud-Paris_Google-App-Engine-Kubernetes_04.jpg[]

* rappel - *2014* : Google faisait dÃ©jÃ  tourner *4 milliards de containers par semaine*

* Alain : mort de Docker avec le rachat par Mirantis (et le split en 2)

.Pourquoi Kubernetes
image:20220621_GDG-Cloud-Paris_Google-App-Engine-Kubernetes_05.jpg[]

* Les montÃ©es de version de Kubernetes peuvent Ãªtre TRES pÃ©nibles
    ** mais sur GKE Ã§a se passent mieux qu'ailleurs... (apparemment c'est beaucoup plus problÃ©matique sur Amazon)

.Pokemon GO et nombre de transactions par seconde (quand le succÃ¨s dÃ©passe toutes les attentes...)
image:20220621_GDG-Cloud-Paris_Google-App-Engine-Kubernetes_06.jpg[]

* on regarde le "worst case" scÃ©nario prÃ©vu et on le compare Ã  la rÃ©alitÃ©... 
    ** et le succÃ¨s a Ã©tÃ© tel que c'est Pokemon GO qui a forcÃ© les ingÃ©nieurs de Google a Ãªtre capable de "mieux pousser les murs"

.Mise en place d'un environnement Kubernetes (d'un cluster Kubernetes)
image:20220621_GDG-Cloud-Paris_Google-App-Engine-Kubernetes_07.jpg[]

.ComplexitÃ©, besoin de customisation et coÃ»t des types d'install Kubernetes
image:20220621_GDG-Cloud-Paris_Google-App-Engine-Kubernetes_08.jpg[]

-> Et on voit l'intÃ©rÃªt de *Kudo Labs* qui vous facilite la vie (et Alain doit bien prÃªcher un peu pour sa paroisse ðŸ˜‰) +
-> Dans tous les cas, *il est (trÃ¨s) souvent nÃ©cessaire de se faire aider* (et cela peut vite coÃ»ter cher !)

.IBM rachÃ¨te Red Hat pour rÃ©cupÃ©rer son expertise sur Kubernetes
[NOTE]
====
Red Hat, pour OpenShift, a tout rÃ©Ã©crit (OpenShift) il y a quelques annÃ©es sur Kubernetes.
Red Hat a donc dÃ©veloppÃ© une expertise sur Kubernetes, principale raison pour laquelle *IBM a rachetÃ© RedHat pour 34 milliards $* : pour rÃ©cupÃ©rer cette expertise Kubernetes.

Et pouvoir vendre (cher) cette expertise. +
-> OpenShift est une solution *chÃ¨re* Ã  faire configurer, faire tourner et maintenir (il faut se faire aider, et cela a un coÃ»t)
====

.DÃ©ploiement d'une application sur Kubernetes
image:20220621_GDG-Cloud-Paris_Google-App-Engine-Kubernetes_09.jpg[]

.Bonnes pratiques avec Kubernetes
image:20220621_GDG-Cloud-Paris_Google-App-Engine-Kubernetes_10.jpg[]
image:20220621_GDG-Cloud-Paris_Google-App-Engine-Kubernetes_11.jpg[]

Plein d'application se sont dÃ©veloppÃ©es sur Kube grÃ¢ce Ã  la Kube API, comme : 

    * *Helm*
    * *Prometheus* / *Grafana*
        ** trÃ¨s puissant, compliquÃ© Ã  mettre en place
        ** Grafana va se connecter Ã  Prometheus pour crÃ©er de bÃ´ diagrammes (qu'on aura dÃ©fini Ã  l'avance)
    * *Istio* : service mesh, plateforme Open Source de gestion et de surveillance de microservices
        ** utilise un Envoy Proxy en side car
    * *Kiali* : outil d'observabilitÃ© pour Istio
    * *KuboScore* : outil d'audit crÃ©Ã© par la boÃ®te d'Alain
        ** va par exemple nous dire quelles sont les network policies utilisÃ©es
        ** va donner un score Ã  votre application
    * *Velero* : permet de sauvegarder le contenu d'un cluster pour le restaurer ailleurs
    * *Argo CD* : commit d'un fichier .yaml, Argo CD va le dÃ©tecter et automatiquement redÃ©ployer ce qui est nÃ©cessaire (Ã  vÃ©rifier) 
    * *KuboVisor* : pour visualiser les problÃ¨mes du cluster Kubernetes +
    image:20220621_GDG-Cloud-Paris_Google-App-Engine-Kubernetes_12.jpg[]
        ** permet d'*anticiper* pas mal de problÃ¨mes potentiels.
    * *Telepresence* : on va se brancher Ã  la place d'un container (interception) pour dÃ©bugage directement sur son IDE

.Le mot de la fin et l'impact pour les dÃ©veloppeurs
image:20220621_GDG-Cloud-Paris_Google-App-Engine-Kubernetes_13.jpg[]
image:20220621_GDG-Cloud-Paris_Google-App-Engine-Kubernetes_14.jpg[]

-> Kubernetes C'EST compliquÃ©, cela VA coÃ»ter en services et en conseil

Contacter alain@kubolabs.io pour des besoins de formation sur Kubernetes ðŸ˜‰ 





